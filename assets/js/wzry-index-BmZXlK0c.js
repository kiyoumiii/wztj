import{aC as k,aQ as x,r as I,aS as $,p as z}from"./wzry-index-Uq5ghgDZ.js";import{l as D,r as c,c as E,w as P,n as L,C as R,y as H,x as V,a5 as A,M as N,u as U,E as C,F,I as K,a0 as Q,L as j,P as q,T as G}from"./wzry-wzry_vue-BxQEaZ6z.js";import"./wzry-index.vue_vue_type_style_index_0_scoped_308049e9_lang-CIECVXAO.js";const Y={mounted(n){n.style.transitionDuration="0.25s",n.style.opacity="0",n.style.transform="scale(0.5)",setTimeout(()=>{n.style.opacity="",n.style.transform=""})}},J=D({__name:"index",props:{data:{},columnCount:{},finish:{type:Boolean,default:!1},loadMore:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},gap:{default:"1rem"},bufferLineCount:{default:1}},emits:["scroll","load-more"],setup(n,{expose:M,emit:_}){const o=n,m=_;let p=0;const s=c(),i=c(),l=c(1e3),v=c([]),b=E(()=>s.value?Math.ceil(s.value.offsetHeight/l.value*o.columnCount):1),w=(e,t=!1)=>{var a;(a=s.value)==null||a.scroll({top:e,behavior:t?"smooth":"auto"})},u=()=>{if(!s.value||!i.value)return;const e=o.data,t=o.columnCount,a=o.bufferLineCount*2,h=s.value.scrollTop,f=Math.max(0,Math.floor(h/l.value)*t-a*t),g=Math.min(e.length,f+b.value+a*t*2),y=[];for(let d=f;d<g;d+=t)y.push(...e.slice(d,d+t));v.value=y;const B=Math.floor(f/t)*l.value,S=Math.floor((e.length-g)/t)*l.value;i.value.style.paddingTop=`${B}px`,i.value.style.paddingBottom=`${S}px`,p=h},T=e=>{const a=e.target.scrollTop;m("scroll",a),Math.abs(a-p)>=l.value&&u()},r=k(()=>{const e=i.value.children[0];e&&(l.value=e.offsetHeight,u())},500);return P(()=>o.data,()=>{L(u)}),R(()=>{window.addEventListener("resize",r),u(),L(r),o.loadMore&&new x({parent:s.value,loadHeight:1},{load(){o.loading||o.finish||m("load-more")}})}),H(()=>{r()}),V(()=>{window.removeEventListener("resize",r)}),A(()=>{window.removeEventListener("resize",r)}),M({_setPosition:w,_updateStatus:r}),(e,t)=>N((C(),F("div",{ref_key:"virtualListRef",ref:s,class:"lib-virtual-list",onScroll:T},[K("div",{ref_key:"fillListRef",ref:i,class:"fill-list",style:j({gridTemplateColumns:`repeat(${e.columnCount}, 1fr)`,gap:e.gap})},[Q(e.$slots,"default",{data:v.value},void 0,!0)],4),e.loadMore?(C(),q($,{key:0,loading:e.loading,finish:e.finish},null,8,["loading","finish"])):G("",!0)],32)),[[U(I)]])}}),Z=z(J,[["__scopeId","data-v-308049e9"]]);export{Z as L,Y as v};
