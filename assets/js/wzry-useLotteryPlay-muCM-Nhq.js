import{bm as fe,m as A,bn as Re,bl as g,bo as te,bk as J,a9 as V,bp as se,p as j,bq as z,br as le,az as ke,F as w,G as _e,y as oe,k as pe,aa as U,ae as Se,X as Ne,ab as ne,j as q,C as W,bj as de,W as ee,I as he,Y as Le,A as Ie,$ as Ce,M as He}from"./wzry-index-Uq5ghgDZ.js";import{K as $e,a as xe}from"./wzry-index-BCpGPkY1.js";import{K as ue}from"./wzry-index-cZRh2pAA.js";import{l as B,E as O,F as k,I as m,S as h,u as t,M as I,O as S,c as f,G as Ye,H as ge,J as ae,X as Q,T as b,P as M,Q as L,r as P,w as be,y as Ae,x as we,N as Ee,L as me,U as G}from"./wzry-wzry_vue-BxQEaZ6z.js";import{s as ce}from"./wzry-wzry_vuePlugin-CVcqpH4P.js";const Me={dq76:`1、优先使用{crystal}夺宝石进行夺宝。
2、{crystal}水晶在幸运值为[{luckValue1}-{luckValue2}]时获得，获取后将[重置]幸运值。
3、{type}夺宝石补给倒计时结束后，不会自动叠加，需要领取补给后再次设置模式，重新倒计时。
4、{type}夺宝石补给每日领取上限为[${fe}]个夺宝石，额外的{type}夺宝次数前往[商城-道具商店]购买。
5、{type}夺宝石补给如果在倒计时没有结束时[终止]，会根据当前已过去的时间，匹配对应的模式奖励。
6、{type}夺宝石补给倒计时是根据[当前时间-开始时间]来计算[剩余时间]，不受关闭浏览器影响。
※、{type}夺宝概率设计：{chance}放入奖池，从奖池随机选择，没有保底机制。`,g5k2:"",j5s5:"",ak79:"",yn25:"",tw50:"",fr16:"",pg06:"",op14:"",sg33:"",kc45:"",mx01:"",dy76:"",xw01:"",en46:"",ku28:"",vf96:"",ib49:"",hv47:""},ie=(o,e)=>{let s=Me[o];return Object.entries(e).forEach(([n,_])=>{s=s.replaceAll(`{${n}}`,_.toString())}),s},Pe={class:"lottery-toolbar"},Ke=["data-text"],De={class:"prop-num"},Ge=B({__name:"index",props:{type:{}},setup(o){const e=o,s=e.type==="HERO"?"英雄":"皮肤",n={HERO:"HERO_LOTTERY_COIN",SKIN:"SKIN_LOTTERY_COIN"},_={HERO:"HERO_LOTTERY_STONE",SKIN:"SKIN_LOTTERY_STONE"},c=()=>{let i="";for(const E in te){const l=Number(E),a=te[l],u=J.HERO.find(T=>T.id===l);i+=`[${a}个${V[u.type]}*${u.num||1}]、`}return i.slice(0,-1)},d=()=>{let i="";for(const E in se){const l=Number(E),a=se[l],u=J.SKIN.find(T=>T.id===l);i+=`[${a}个${V[u.type]}*${u.num||1}]、`}return i.slice(0,-1)},r=()=>{Re({title:`${e.type==="HERO"?"英雄":"皮肤"}夺宝说明`,content:e.type==="HERO"?ie("dq76",{crystal:"王者",type:"英雄",luckValue1:g.hero[0],luckValue2:g.hero[1],chance:c()}):ie("dq76",{crystal:"荣耀",type:"皮肤",luckValue1:g.skin[0],luckValue2:g.skin[1],chance:d()})})};return(i,E)=>(O(),k("div",Pe,[m("div",{class:"title","data-text":t(s)+"夺宝"},h(t(s))+"夺宝",9,Ke),I(S(t($e),{"margin-left":"1rem",onClick:r},null,512),[[t(A)]]),m("div",De,[S(t(ue),{"prop-key":n[i.type],gap:"0.75rem",height:"3rem","font-size":"2.25rem","margin-right":"2rem"},null,8,["prop-key"]),S(t(ue),{"prop-key":_[i.type],gap:"0.75rem",height:"3rem","font-size":"2.25rem"},null,8,["prop-key"])])]))}}),kt=j(Ge,[["__scopeId","data-v-4824eab8"]]),Ve={class:"supply-mode"},Ue={class:"title"},je={key:0,class:"mode-list"},ze=["data-text","onClick"],Be={key:1,class:"ready-start"},Fe={class:"tip"},Xe={class:"prop"},qe=["src"],We={class:"btns"},Je={class:"supply-remain-num"},Qe={class:"value"},Ze=B({__name:"index",props:{type:{}},setup(o){const e=o,s=z(),{setTimeMode:n,startCountdown:_}=s,{hero_mode:c,skin_mode:d,skin_supply_status:r,hero_supply_status:i,hero_supply_remain_num:E,skin_supply_remain_num:l}=ce(s),{playAudio:a}=pe(),u=e.type==="HERO"?c:d,T=e.type==="HERO"?i:r,$=e.type==="HERO"?"HERO_LOTTERY_STONE":"SKIN_LOTTERY_STONE",x=e.type==="HERO"?E:l,F=f(()=>({SELECT:"请选择补给模式",READY:"准备开始"})[T.value]),Y=C=>{n(e.type,C),a("v6p0")},N=()=>{a("pj83")};return(C,R)=>(O(),k("div",Ve,[m("div",Ue,h(F.value),1),t(T)==="SELECT"?(O(),k("div",je,[(O(!0),k(Ye,null,ge(t(ke).LOTTERY_SUPPLY_MODE,(H,K)=>I((O(),k("div",{key:K,class:ae([t(le)(H.seconds),"mode"]),"data-text":H.label,onClick:Z=>Y(K)},[Q(h(H.label),1)],10,ze)),[[t(A)]])),128))])):b("",!0),t(T)==="READY"&&t(u)?(O(),k("div",Be,[m("div",{class:ae(["desc",t(le)(t(u).seconds)])},h(t(u).label),3),m("div",Fe,[R[1]||(R[1]=m("div",{class:"text"},"倒计时结束后可领取",-1)),m("div",Xe,[m("img",{src:t(w)(t(_e).ICON[t($)]),alt:"",class:"icon"},null,8,qe),m("span",null,"×"+h(t(u).count),1)])]),m("div",We,[I((O(),M(t(oe),{class:"k-button",type:"warning",onClick:R[0]||(R[0]=H=>(t(_)(C.type),N()))},{default:L(()=>R[2]||(R[2]=[Q(" 开始 ")])),_:1})),[[t(A)]])])])):b("",!0),m("div",Je,[R[3]||(R[3]=m("div",{class:"label"},"今日补给剩余额度：",-1)),m("div",Qe,h(t(x)),1)])]))}}),et=j(Ze,[["__scopeId","data-v-f317c82c"]]),tt=()=>{const o=[],e={left:[0,0],top:[0,0]},s=P(),n=P(0),_=f(()=>o[n.value]);for(const a in U)o.push(w(U[a]));const c=()=>{n.value++,n.value>=o.length&&(n.value=0)},d=(a,u)=>{s.value&&(c(),s.value.style[a]=`calc(100% - ${s.value.offsetWidth/16}rem)`,e[a][0]=setTimeout(()=>{s.value&&(c(),s.value.style[a]="0%",e[a][1]=setTimeout(()=>{d(a,u)},u))},u))},r=()=>d("left",7200),i=()=>d("top",4600);return{img:_,circularRef:s,startAnimate:()=>{s.value.style.left="0%",s.value.style.top="0%",setTimeout(()=>{r(),i()},10)},clearAnimate:()=>{[...e.left,...e.top].forEach(a=>{clearTimeout(a)})}}},st={class:"animate-move"},ot=["src"],nt=B({__name:"index",props:{type:{}},setup(o,{expose:e}){const s=o,n=z(),{circularRef:_,img:c,startAnimate:d,clearAnimate:r}=tt(),i=f(()=>s.type==="HERO"?n.hero_countdown:n.skin_countdown),E=f(()=>(s.type==="HERO"?n.hero_supply_status:n.skin_supply_status)==="RUNNING");return be(E,l=>{l?d():r()}),Ae(()=>{E.value&&d()}),we(r),e({_clearAnimate:r}),(l,a)=>(O(),k("div",st,[m("img",{src:t(c),class:"bg",alt:""},null,8,ot),I(m("div",{ref_key:"circularRef",ref:_,class:"circular",style:me({backgroundImage:`url(${t(c)})`})},null,4),[[Ee,E.value]]),S(G,{name:"fade"},{default:L(()=>[E.value?(O(),M(t(xe),{key:0,class:"k-scroll-countdown",nums:i.value},null,8,["nums"])):b("",!0)]),_:1})]))}}),at=j(nt,[["__scopeId","data-v-68e51d55"]]),ct={class:"receive-prop"},rt={class:"title"},lt={class:"prop"},ut={class:"count"},it={class:"btns"},_t=B({__name:"index",props:{type:{}},setup(o){const e=o,s=z(),n=Se(),{hero_mode:_,skin_mode:c}=ce(s),d=e.type==="HERO"?_:c,r=e.type==="HERO"?"HERO_LOTTERY_STONE":"SKIN_LOTTERY_STONE",i=()=>{const l=d.value.count;ne({icon:w(U[r]),name:V[r],num:l,key:r}),r==="HERO_LOTTERY_STONE"?n.setTaskStatus("today_hero_supply",l):n.setTaskStatus("today_skin_supply",l),s.setSupplyRemainNum(e.type,l),s.setSupplyStatus(e.type,"IDLE")},E=()=>{i(),s.startCountdown(e.type)};return(l,a)=>{var u;return O(),k("div",ct,[m("div",rt,"本次时长："+h(t(Ne)(t(d).seconds)),1),m("div",lt,[m("div",{class:"icon",style:me({backgroundImage:`url(${t(w)(t(_e).ICON[t(r)])})`})},null,4),m("div",ut,"×"+h((u=t(d))==null?void 0:u.count),1)]),m("div",it,[I((O(),M(t(oe),{class:"k-button",type:"warning",onClick:i},{default:L(()=>a[0]||(a[0]=[Q("领取")])),_:1})),[[t(A)]]),I((O(),M(t(oe),{class:"k-button",type:"warning",onClick:E},{default:L(()=>a[1]||(a[1]=[Q(" 领取并继续 ")])),_:1})),[[t(A)]])])])}}}),pt=j(_t,[["__scopeId","data-v-9c86ef52"]]),dt={class:"supply-area"},Et=B({__name:"index",props:{type:{}},setup(o){const e=o,s=z(),{playAudio:n}=pe(),_=P(),c=f(()=>e.type==="HERO"?s.hero_supply_status:s.skin_supply_status),d=()=>{if(c.value==="RUNNING"){q({text:W.jn63,confirm(){_.value._clearAnimate(),s.stopCountdown(e.type),n("pk92")}});return}if(c.value!=="IDLE"){s.setSupplyStatus(e.type,"IDLE"),n("pk92");return}n(),s.setSupplyStatus(e.type,"SELECT")};return(r,i)=>(O(),k("div",dt,[S(G,{name:"fade"},{default:L(()=>[c.value!=="RECEIVE"?I((O(),k("i",{key:0,class:ae(["iconfont",[{active:c.value!=="IDLE"},c.value==="RUNNING"?"wzry-tingzhi":"wzry-kaiguan"]]),onClick:d},null,2)),[[t(A)]]):b("",!0)]),_:1}),i[0]||(i[0]=m("div",{class:"text"},"夺宝石补给站",-1)),S(G,{name:"fade"},{default:L(()=>[["SELECT","READY"].includes(c.value)?(O(),M(et,{key:0,type:r.type},null,8,["type"])):b("",!0)]),_:1}),S(G,{name:"fade"},{default:L(()=>[I(S(at,{ref_key:"animateMoveRef",ref:_,type:r.type},null,8,["type"]),[[Ee,c.value!=="IDLE"]])]),_:1}),S(G,{name:"fade"},{default:L(()=>[c.value==="RECEIVE"?(O(),M(pt,{key:0,type:r.type},null,8,["type"])):b("",!0)]),_:1})]))}}),St=j(Et,[["__scopeId","data-v-9dd1352d"]]);function mt(o){const e=de(),s=o==="HERO"?te:se,n=o==="HERO"?"hero_lucky":"skin_lucky",_=o==="HERO"?g.hero:g.skin,c={gift_index:P(0),crystal_index:P(ee(_[0],_[1]))},{gift_index:d,crystal_index:r}=c;return{...c,...{getLotteryIndex(){if(e[n]===r.value){d.value=0,r.value=ee(_[0],_[1]);return}const E=[];for(const[T,$]of Object.entries(s))for(let x=0;x<$;x++)E.push(Number(T));const l=he(E),a=ee(0,E.length-1),u=l[a];d.value=J[o].findIndex(T=>T.id===u)}}}}const Nt=o=>{const e=Le(),s=de(),n=z(),_=Ie(),{hero_supply_status:c,skin_supply_status:d}=ce(n),{resetHeroLuck:r,resetSkinLuck:i,saveGameData:E}=s,{gift_index:l,getLotteryIndex:a}=mt(o),u=J[o],T=o==="HERO"?r:i,$=o==="HERO"?c:d,x=o==="HERO"?"KING_CRYSTAL":"HONOR_CRYSTAL",F=o==="HERO"?"HERO_LOTTERY_STONE":"SKIN_LOTTERY_STONE",Y=o==="HERO"?"HERO_LOTTERY_COIN":"SKIN_LOTTERY_COIN";let N=!1;const C={gift_index:l,last_reward_position:P(0)},{last_reward_position:R}=C,H=f(()=>_.user_data.doubleGoldCardExpireTime!==0),K=f(()=>_.user_data.doubleExpCardExpireTime!==0),Z={have_alone_free:f(()=>{const p=e.articles;return(o==="HERO"?p.HERO_LOTTERY_COIN:p.SKIN_LOTTERY_COIN)>=1}),have_multiple_free:f(()=>{const p=e.articles;return(o==="HERO"?p.HERO_LOTTERY_COIN:p.SKIN_LOTTERY_COIN)>=5}),have_alone_discount:f(()=>{const p=e.articles;return(o==="HERO"?p.HERO_LOTTERY_STONE:p.SKIN_LOTTERY_STONE)>0}),have_multiple_discount:f(()=>{const p=e.articles;return(o==="HERO"?p.HERO_LOTTERY_STONE:p.SKIN_LOTTERY_STONE)>=5})},{have_alone_free:ye,have_multiple_free:Oe,have_alone_discount:Te,have_multiple_discount:ve}=Z;return{...C,...Z,...{getLotteryIndex:a,checkAloneNotCount(){return N?!0:!ye.value&&!Te.value?(q({text:W.yb85,confirm(){if($.value==="IDLE"){n.setTimeMode(o,0),n.startCountdown(o);return}$.value==="RUNNING"&&Ce(He.yz00,"warning")}}),!0):(N=!0,!1)},checkMultipleNotCount(p,y){return N?!0:(a(),!ve.value&&p==="DEDUCTION"?(q({text:W.qv90,confirm(){setTimeout(()=>{y()},1250)}}),!0):!Oe.value&&p==="FREE"?(q({text:W.wr91,confirm(){setTimeout(()=>{y()},1250)}}),!0):(N=!0,!1))},setLastPosition(p){R.value=p},calcAloneReward(){N=!1,e.articles[Y]>0?e.setGamePropNum(Y,1,"SUB"):e.setGamePropNum(F,1,"SUB");let p=u[l.value].num;const y=u[l.value].type;y===x&&T(),y==="GOLD"&&H.value&&(p*=2),["HERO_EXP_ONE","HERO_EXP_TWO"].includes(y)&&K.value&&(p*=2),ne({name:V[y],num:p,icon:w(U[y])}),E()},calcMultipleReward(p){N=!1,e.articles[Y]>0?e.setGamePropNum(Y,5,"SUB"):e.setGamePropNum(F,5,"SUB");const y={};p.forEach(X=>{const v=u[X].type,D=u[X].num;y[v]??(y[v]=0),y[v]+=D||1});const re=[];for(const X in y){const v=X;let D=y[v];v==="GOLD"&&H.value&&(D*=2),["HERO_EXP_ONE","HERO_EXP_TWO"].includes(v)&&K.value&&(D*=2),re.push({num:D,name:V[v],key:v,icon:w(U[v])})}ne(re),E()}}}};export{kt as L,St as S,Nt as u};
